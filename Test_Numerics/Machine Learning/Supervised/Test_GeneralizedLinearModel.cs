/*
* NOTICE:
* The U.S. Army Corps of Engineers, Risk Management Center (USACE-RMC) makes no guarantees about
* the results, or appropriateness of outputs, obtained from Numerics.
*
* LIST OF CONDITIONS:
* Redistribution and use in source and binary forms, with or without modification, are permitted
* provided that the following conditions are met:
* ● Redistributions of source code must retain the above notice, this list of conditions, and the
* following disclaimer.
* ● Redistributions in binary form must reproduce the above notice, this list of conditions, and
* the following disclaimer in the documentation and/or other materials provided with the distribution.
* ● The names of the U.S. Government, the U.S. Army Corps of Engineers, the Institute for Water
* Resources, or the Risk Management Center may not be used to endorse or promote products derived
* from this software without specific prior written permission. Nor may the names of its contributors
* be used to endorse or promote products derived from this software without specific prior
* written permission.
*
* DISCLAIMER:
* THIS SOFTWARE IS PROVIDED BY THE U.S. ARMY CORPS OF ENGINEERS RISK MANAGEMENT CENTER
* (USACE-RMC) "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
* THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
* DISCLAIMED. IN NO EVENT SHALL USACE-RMC BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
* PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
* INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
* LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
* THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

using Microsoft.VisualStudio.TestTools.UnitTesting;
using Numerics.Data;
using Numerics.MachineLearning;
using Numerics.Mathematics.LinearAlgebra;
using Numerics;
using System.Collections.Generic;
using Numerics.Data.Statistics;
using System.Diagnostics;
using System.ComponentModel.DataAnnotations;
using Microsoft.VisualBasic;

namespace MachineLearning
{
    /// <summary>
    /// Unit tests for Generalized Linear Model .
    /// </summary>
    /// <remarks>
    /// <para>
    ///     <b> Authors: </b>
    ///     <list type="bullet"> 
    ///     <item> Haden Smith, USACE Risk Management Center, cole.h.smith@usace.army.mil </item>
    /// </list>
    /// </para>
    /// </remarks>
    [TestClass]
    public class Test_GeneralizedLinearModel
    {

        /// <summary>
        /// Test simple linear regression. 
        /// </summary>
        [TestMethod]
        public void Test_SimpleLinearRegression()
        {
            var consumption = new double[] { 0.61598622, 0.46037569, 0.87679142, -0.27424514, 1.89737076, 0.91199291, 0.79453885, 1.64858747, 1.31372218, 1.89147495, 1.530714, 2.31829471, 1.81073916, -0.04173996, 0.35423556, -0.29163216, -0.87702794, 0.35113555, 0.4095977, -1.47580863, 0.83225762, 1.65583461, 1.41942029, 1.05437932, 1.97998024, 0.91391607, 1.05532326, 1.29889825, 1.13637586, 0.54994073, 0.94985262, 1.49599724, 0.57549599, 2.1112096, 0.41796279, 0.7979271, 0.50584598, -0.05775339, 0.9773001, 0.26826982, -0.15391875, -2.27411019, 1.07188123, 1.31644941, 0.5247277, -0.01728203, 0.4016515, -0.7528762, 0.65938376, 0.36854173, 0.76954464, 1.80876006, 0.96802954, 1.95946831, 1.73949442, 1.56389332, 0.84526442, 1.41504495, 0.76546608, 1.31380062, 1.6865532, 0.9343699, 1.90256675, 0.25656565, 0.84304279, 1.1117739, 1.79499406, 0.63768446, 0.01569397, 1.37731686, 1.15225712, 0.21016439, 1.76316026, 0.73053714, 0.85083233, 1.13789838, 0.46064152, 0.46937808, 0.98950145, 0.43942767, 0.85543417, 0.31230451, 0.40261313, -0.75910716, -0.34535008, 0.83564224, 0.48439843, -0.02626579, 1.85996999, 0.68354371, 1.07661214, 1.18372396, 0.37817936, 0.89392729, 1.09813766, 0.88122025, 1.14064791, 0.77176225, 0.77214364, 1.07014805, 0.26420505, 0.89311141, 0.91264702, 0.70025425, 0.92360967, 1.07997887, 0.60055799, 0.78298122, 1.04949253, 0.45219855, 1.69654264, 1.18062797, 1.02693626, 1.75069399, 1.30596977, 1.45888615, 0.94821191, 1.46971415, 1.12921436, 1.45748895, 1.51106759, 0.95508878, 0.96797647, 0.88629738, 0.42159086, 0.25689982, 0.36381084, 1.51630321, 0.29958257, 0.50899032, 0.69667241, 0.53634306, 0.43826169, 1.10719086, 1.46377882, 0.77334046, 0.96768535, 0.64760607, 0.95117167, 1.02041702, 0.76172556, 1.08136588, 0.77186494, 0.37591485, 1.11522822, 0.53100554, 0.58208747, 1.01434389, 0.52486184, 0.33874119, 0.44391875, 0.12505584, -0.20652548, 0.16783443, -0.72499446, -1.21068558, -0.3435437, -0.45174364, 0.60491332, -0.01115014, 0.5348174, 0.81040406, 0.64501881, 1.01833874, 0.50041315, 0.20141978, 0.43372599, 0.33593895, 0.60108995, 0.16942956, 0.26416034, 0.27877186, 0.46861292, 0.20545802, 0.46641787, 0.83917367, 0.47345118, 0.93375698, 0.91687178, 1.1253325, 0.59624005, 0.70814389, 0.66496956, 0.56167978, 0.40468216, 1.04770741, 0.72959779 };
            var income = new double[] { 0.97226104, 1.16908472, 1.55327055, -0.25527238, 1.98715363, 1.44733417, 0.53181193, 1.16012514, 0.4570115, 1.01662441, 1.90410126, 3.89025866, 0.70825266, 0.79430954, 0.43381827, 1.09380979, -1.66168482, -0.93835321, 0.09448779, -0.12259599, -0.16369546, 4.53650956, -1.46376532, 0.76166351, 1.16825761, 0.51729906, 0.73370026, 0.59458339, -0.03108003, 1.23808955, 1.51880293, 1.9145624, 0.70266687, 0.98314132, 0.7199262, 0.78553605, 1.05755946, -0.86765105, 0.4710034, 0.44037974, 0.33827686, -1.46388507, 1.21301507, 1.94243865, -0.26813406, -0.02363025, 2.02680183, 0.19560628, 0.11969888, 0.57548997, 0.5348441, 0.44938311, 0.85588425, 0.70632719, 1.49810999, 2.13138911, 2.02348788, 1.64921136, 1.36163845, 0.81927319, -0.23895759, 1.90677905, -0.33536283, 1.14181151, 1.2395111, 1.31938549, 0.7047715, 0.17977925, 0.81973366, -0.97505791, 1.80185055, 1.32743427, 1.44861875, 1.02084894, 0.95820336, 0.96207024, 1.22693023, -0.29489091, 0.67822897, 0.80025832, 0.83939484, 0.59572848, 0.03740765, -0.79479735, 0.2118329, 0.69043356, 0.36205181, 0.85100324, 2.12421067, 1.04095059, 0.43562041, 0.34210852, 0.55877186, 0.17627103, 0.05868803, 0.65496353, 0.69846579, 1.05367166, 0.59247377, 1.38110661, 0.94873528, 0.22780635, 0.88957006, 0.57591998, 0.95255663, 0.95161791, 0.79369738, 0.52035746, 0.99858552, 0.85103564, 1.18352222, 1.42325742, 2.10753052, 1.38767133, 1.01464427, 0.80893032, 0.89173174, 0.24722185, 0.66729226, 1.46092242, 1.95061335, 1.03174349, 1.16178668, 0.33725343, 0.84865826, -0.08818148, 2.3367892, -1.24443353, 2.40331419, 0.50559877, -0.12828194, 0.47941927, 0.27834026, 1.43729445, 1.62544947, 0.40353864, 0.72653162, 0.98056746, 0.52450113, 1.24238706, -0.96827007, 0.78835467, 0.51136949, 0.82191843, 2.25904474, 0.14987813, 0.28490722, 1.30059162, 0.65373993, 0.1926087, 0.26238732, 0.08392938, 0.71926565, 2.08693775, -2.3261186, 0.64019534, -0.18888849, 0.70899368, -1.1034318, -0.13213193, 0.10094986, 1.29229259, 0.49678098, 0.69495229, 1.21571502, -0.15658108, 0.52891255, 0.06074719, 1.62204885, 0.76689543, -0.05071452, 2.59106697, -4.26525047, 0.58146541, 0.58328912, 0.21494896, 1.10369487, 1.29390492, 0.99853396, 1.04641801, 0.4904068, 0.95495949, 0.80166267, 0.7400626, 0.5190254, 0.72372078, 0.64470081 };
            var y = new Vector(consumption) { Header = "Consumption" };
            var x = new Matrix(income) { Header = new string[] { "Income" } };
            var GLM = new GeneralizedLinearModel(x, y);
            GLM.Train();
            var a = GLM.Parameters[0];
            var b = GLM.Parameters[1];
            var sigA = GLM.ParameterStandardErrors[0];
            var sigB = GLM.ParameterStandardErrors[1];
            var se = GLM.StandardError;
            var df = GLM.DegreesOfFreedom;

            var true_a = 0.54510;
            var true_b = 0.28060;
            var true_se = 0.6026;
            var true_sigA = 0.05569;
            var true_sigB = 0.04744;
            // var true_r2 = 0.159; Never used below. 
            var true_df = 185;

            Assert.AreEqual(a, true_a, 1E-3);
            Assert.AreEqual(b, true_b, 1E-3);
            Assert.AreEqual(sigA, true_sigA, 1E-3);
            Assert.AreEqual(sigB, true_sigB, 1E-3);
            Assert.AreEqual(se, true_se, 1E-3);
            Assert.AreEqual(df, true_df);

            // Test summary output table 
            var summary = GLM.Summary();
            for (int i = 0; i < summary.Count; i++)
            {
                //Debug.WriteLine(summary[i]);
            }

            /**  
                Generalized Linear Model (187 obs, 2 parameters):
                Model for predicting Consumption:
                Parameters:
                                   Estimate  Std. Error     z value    Pr(>|z|)
                Intercept           0.54510     0.05569       9.789     < 1E-15 ***
                β1                  0.28057     0.04744       5.914   3.34E-009 ***
                ---
                Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

                Residual standard error: 0.6026 on 185 degrees of freedom
                AIC: 71.1801  AICc: 71.2453  BIC: 77.6423

                Residuals:
                       Min        1Q    Median        3Q       Max
                   -2.4085   -0.3181    0.0256    0.2998    1.4516
            **/

        }


        /// <summary>
        /// Test multiple linear regression. 
        /// </summary>
        [TestMethod]
        public void Test_MultipleLinearRegression()
        {
            var consumption = new double[] { 0.61598622, 0.46037569, 0.87679142, -0.27424514, 1.89737076, 0.91199291, 0.79453885, 1.64858747, 1.31372218, 1.89147495, 1.530714, 2.31829471, 1.81073916, -0.04173996, 0.35423556, -0.29163216, -0.87702794, 0.35113555, 0.4095977, -1.47580863, 0.83225762, 1.65583461, 1.41942029, 1.05437932, 1.97998024, 0.91391607, 1.05532326, 1.29889825, 1.13637586, 0.54994073, 0.94985262, 1.49599724, 0.57549599, 2.1112096, 0.41796279, 0.7979271, 0.50584598, -0.05775339, 0.9773001, 0.26826982, -0.15391875, -2.27411019, 1.07188123, 1.31644941, 0.5247277, -0.01728203, 0.4016515, -0.7528762, 0.65938376, 0.36854173, 0.76954464, 1.80876006, 0.96802954, 1.95946831, 1.73949442, 1.56389332, 0.84526442, 1.41504495, 0.76546608, 1.31380062, 1.6865532, 0.9343699, 1.90256675, 0.25656565, 0.84304279, 1.1117739, 1.79499406, 0.63768446, 0.01569397, 1.37731686, 1.15225712, 0.21016439, 1.76316026, 0.73053714, 0.85083233, 1.13789838, 0.46064152, 0.46937808, 0.98950145, 0.43942767, 0.85543417, 0.31230451, 0.40261313, -0.75910716, -0.34535008, 0.83564224, 0.48439843, -0.02626579, 1.85996999, 0.68354371, 1.07661214, 1.18372396, 0.37817936, 0.89392729, 1.09813766, 0.88122025, 1.14064791, 0.77176225, 0.77214364, 1.07014805, 0.26420505, 0.89311141, 0.91264702, 0.70025425, 0.92360967, 1.07997887, 0.60055799, 0.78298122, 1.04949253, 0.45219855, 1.69654264, 1.18062797, 1.02693626, 1.75069399, 1.30596977, 1.45888615, 0.94821191, 1.46971415, 1.12921436, 1.45748895, 1.51106759, 0.95508878, 0.96797647, 0.88629738, 0.42159086, 0.25689982, 0.36381084, 1.51630321, 0.29958257, 0.50899032, 0.69667241, 0.53634306, 0.43826169, 1.10719086, 1.46377882, 0.77334046, 0.96768535, 0.64760607, 0.95117167, 1.02041702, 0.76172556, 1.08136588, 0.77186494, 0.37591485, 1.11522822, 0.53100554, 0.58208747, 1.01434389, 0.52486184, 0.33874119, 0.44391875, 0.12505584, -0.20652548, 0.16783443, -0.72499446, -1.21068558, -0.3435437, -0.45174364, 0.60491332, -0.01115014, 0.5348174, 0.81040406, 0.64501881, 1.01833874, 0.50041315, 0.20141978, 0.43372599, 0.33593895, 0.60108995, 0.16942956, 0.26416034, 0.27877186, 0.46861292, 0.20545802, 0.46641787, 0.83917367, 0.47345118, 0.93375698, 0.91687178, 1.1253325, 0.59624005, 0.70814389, 0.66496956, 0.56167978, 0.40468216, 1.04770741, 0.72959779 };
            var income = new double[] { 0.97226104, 1.16908472, 1.55327055, -0.25527238, 1.98715363, 1.44733417, 0.53181193, 1.16012514, 0.4570115, 1.01662441, 1.90410126, 3.89025866, 0.70825266, 0.79430954, 0.43381827, 1.09380979, -1.66168482, -0.93835321, 0.09448779, -0.12259599, -0.16369546, 4.53650956, -1.46376532, 0.76166351, 1.16825761, 0.51729906, 0.73370026, 0.59458339, -0.03108003, 1.23808955, 1.51880293, 1.9145624, 0.70266687, 0.98314132, 0.7199262, 0.78553605, 1.05755946, -0.86765105, 0.4710034, 0.44037974, 0.33827686, -1.46388507, 1.21301507, 1.94243865, -0.26813406, -0.02363025, 2.02680183, 0.19560628, 0.11969888, 0.57548997, 0.5348441, 0.44938311, 0.85588425, 0.70632719, 1.49810999, 2.13138911, 2.02348788, 1.64921136, 1.36163845, 0.81927319, -0.23895759, 1.90677905, -0.33536283, 1.14181151, 1.2395111, 1.31938549, 0.7047715, 0.17977925, 0.81973366, -0.97505791, 1.80185055, 1.32743427, 1.44861875, 1.02084894, 0.95820336, 0.96207024, 1.22693023, -0.29489091, 0.67822897, 0.80025832, 0.83939484, 0.59572848, 0.03740765, -0.79479735, 0.2118329, 0.69043356, 0.36205181, 0.85100324, 2.12421067, 1.04095059, 0.43562041, 0.34210852, 0.55877186, 0.17627103, 0.05868803, 0.65496353, 0.69846579, 1.05367166, 0.59247377, 1.38110661, 0.94873528, 0.22780635, 0.88957006, 0.57591998, 0.95255663, 0.95161791, 0.79369738, 0.52035746, 0.99858552, 0.85103564, 1.18352222, 1.42325742, 2.10753052, 1.38767133, 1.01464427, 0.80893032, 0.89173174, 0.24722185, 0.66729226, 1.46092242, 1.95061335, 1.03174349, 1.16178668, 0.33725343, 0.84865826, -0.08818148, 2.3367892, -1.24443353, 2.40331419, 0.50559877, -0.12828194, 0.47941927, 0.27834026, 1.43729445, 1.62544947, 0.40353864, 0.72653162, 0.98056746, 0.52450113, 1.24238706, -0.96827007, 0.78835467, 0.51136949, 0.82191843, 2.25904474, 0.14987813, 0.28490722, 1.30059162, 0.65373993, 0.1926087, 0.26238732, 0.08392938, 0.71926565, 2.08693775, -2.3261186, 0.64019534, -0.18888849, 0.70899368, -1.1034318, -0.13213193, 0.10094986, 1.29229259, 0.49678098, 0.69495229, 1.21571502, -0.15658108, 0.52891255, 0.06074719, 1.62204885, 0.76689543, -0.05071452, 2.59106697, -4.26525047, 0.58146541, 0.58328912, 0.21494896, 1.10369487, 1.29390492, 0.99853396, 1.04641801, 0.4904068, 0.95495949, 0.80166267, 0.7400626, 0.5190254, 0.72372078, 0.64470081 };
            var production = new double[] { -2.45270031, -0.55152509, -0.35870786, -2.18545486, 1.90973412, 0.90153584, 0.30801942, 2.29130441, 4.14957387, 1.89062398, 1.2733529, 3.43689207, 2.79907636, 0.81768862, 0.86899693, 1.47296187, -0.88248358, 0.07427919, -0.41314971, -4.06411893, -6.85103912, -1.33129558, 2.42435972, 2.16904208, 3.02720471, 1.27881101, 1.30386487, 1.77537765, 2.05516067, 3.05838507, 1.10308888, 0.6334685, -0.29339056, 3.94815264, 0.87114701, 1.78447991, 0.42594327, -0.20491944, -0.29723637, 0.33560928, 0.41056141, -4.30076832, -1.64181977, 3.7804552, 0.24627687, 0.30977573, 0.91707444, -2.25457797, -2.07131293, -1.24766384, -1.4005043, -1.90375664, 1.1465572, 2.17942248, 3.36771897, 2.58168445, 2.89709545, 1.53821324, 0.7212874, 0.04115557, 0.32353159, 0.07020996, -0.14046924, 0.57978813, 0.58132135, -0.57641778, 0.37249329, 1.13734778, 1.30758228, 1.75000563, 1.843662, 2.40645058, 0.92013121, 0.87316353, 0.38103668, 0.70292025, 0.43372685, -0.36675732, -0.62142121, 0.42443392, 0.68265169, 0.77446547, 0.419448, -1.57345296, -1.91422028, 0.59131506, 1.36255645, 0.21710308, -0.13365365, 1.76874773, 0.76167388, 1.05024577, 0.87901471, 0.21755108, 0.40135891, 1.49618275, 1.22213656, 1.78250275, 1.267181, 2.04370404, 1.02552601, 0.33785685, 0.90043887, 0.87467273, 0.69285195, 2.11134752, 1.2441868, 1.3539689, 1.867147, 1.48763922, 2.28632066, 2.48091341, 1.10343775, 0.65122238, 0.72551955, 1.44421674, 1.10341663, 0.98574261, 0.90279881, 1.75533234, 0.99682019, 1.23293805, -0.10225268, -0.20388383, -1.35143911, -1.25954437, -1.44101744, -1.06013675, 0.70916406, 1.54280957, 0.59478143, -0.05776556, 0.53922789, -0.69876172, 0.60727351, 1.00599126, 0.65792806, 0.5746178, 0.5633003, 1.38522763, 1.39435718, 0.50586367, -0.50305848, 0.9336501, 0.95057853, 0.5963601, 0.33552773, 0.25603401, 0.91794957, 1.19594247, 0.22356909, 0.16424632, -0.42872571, -1.41297022, -3.26349945, -4.35417741, -5.75045075, -3.00372447, 1.39880419, 1.54400617, 1.88006931, 2.05402479, 1.42683671, 0.37927209, 0.5017404, 0.21878696, 1.01113866, 0.85151692, 0.88651817, 0.62923586, 0.07880166, 0.63305509, 0.67713243, 0.30744961, 0.23440888, 0.79208722, 0.54709166, 1.33801074, 0.62352731, 0.90355427, -0.46710878, -0.69702162, 0.3806061, -0.84554638, -0.41793048, -0.20331883, 0.47491844 };
            var savings = new double[] { 4.8103115, 7.28799234, 7.28901306, 0.98522964, 3.65777061, 6.0513418, -0.44583221, -1.53087186, -4.35859438, -5.05452579, 5.80995904, 16.04471706, -5.34886849, 8.42603436, 2.75879565, 11.14642986, -2.53351449, -6.59264464, 0.51717884, 11.3433954, -5.47619069, 24.30960536, -17.65616104, 0.64809041, -2.95006644, -1.47455755, -0.06754475, -3.57672239, -9.16055658, 9.09050404, 7.94495719, 6.69627648, 2.92296383, -6.81114259, 4.79207162, 2.371184, 7.77418337, -5.28634896, -1.84549644, 4.0495981, 5.86168864, 8.24322919, 5.70775044, 9.15098787, -5.68139002, 0.88183993, 15.99035721, 7.8055065, -3.34243955, 2.19400166, 0.03499563, -9.57651468, 0.3459546, -10.17004699, 0.21217916, 8.21600068, 13.8691815, 4.38900229, 6.51686089, -2.87544931, -18.71008389, 11.8287195, -23.57393474, 11.36628338, 5.86126836, 3.27551734, -10.09044542, -4.82920131, 12.46424452, -29.52866718, 12.32810406, 16.63076101, -0.96896505, 5.67776867, 3.64649867, -0.19730358, 10.01461545, -8.15576525, -2.48622554, 5.44681102, 2.87544931, 5.10951644, -3.17767248, -0.17953326, 6.49315257, -0.30920615, -0.14086493, 11.3419301, 7.2326515, 5.46708666, -5.9364609, -5.88618856, 2.63464703, -6.91664675, -11.99337844, -1.8370887, -5.18600629, 5.15609751, -2.42215898, 6.32351898, 10.11514398, -10.60541172, -0.11570727, -2.90726686, 2.55933958, -0.75802112, 3.33843952, -3.33843952, 0.61269338, 6.17532322, -7.22796452, 5.43456565, 19.35335228, -4.81709478, -3.12983982, -9.14923404, 1.88735718, -23.49652903, -9.86264835, 2.35825225, 12.2868408, 1.28001748, 2.57390229, -13.16296208, 13.22491995, -6.89043916, 41.66826457, -56.75209674, 50.75796205, 0.87861837, -14.70397426, 1.58733492, 0.49744834, 7.00891625, 6.1841315, -6.89274778, -2.9615204, 8.30885627, -8.99318286, 6.23585017, -42.28191228, -18.27592893, -7.87665229, 20.37236078, 37.40653542, -12.34810568, -10.5527614, 6.0310008, 6.60516929, -7.23648452, -9.00674555, 2.32887238, 29.83728599, 46.43989041, -32.53252494, 36.3124049, 0.9230602, 16.09059408, -24.49229966, 0.8482922, -5.54399051, 11.65612884, -0.35208609, -3.27335958, 14.33860193, -4.07705131, 2.722504, -3.45447712, 17.6253051, 8.9694971, -3.04922177, 29.04670355, -68.78826698, 7.81647729, 3.49400682, -11.2766145, 13.52020248, 8.2440477, 2.46195256, -1.51305022, -0.75840017, 5.02391773, 3.18092976, 3.48278601, 2.23653405, -2.72150106, -0.57285793 };
            var unemployment = new double[] { 0.9, 0.5, 0.5, 0.7, -0.1, -0.1, 0.1, 0, -0.2, -0.1, -0.2, -0.3, -0.3, 0, -0.1, 0.1, 0.2, 0.3, 0.5, 1.3, 1.4, 0.2, -0.4, -0.2, -0.6, 0, 0, 0.2, -0.4, -0.2, -0.4, -0.4, -0.1, -0.4, 0.1, 0, -0.2, -0.1, 0.2, 0.1, 0.3, 1.3, -0.1, -0.3, 0.2, 0.1, 0.1, 0.9, 0.5, 0.6, 0.5, 0.7, -0.5, -0.2, -0.9, -0.9, -0.5, -0.6, 0.1, 0, -0.1, 0.2, -0.3, -0.1, 0.2, 0, -0.2, -0.4, 0, -0.4, -0.3, -0.2, 0, -0.3, 0, -0.1, -0.3, 0.3, 0, 0.1, -0.2, 0, 0.7, 0.4, 0.5, 0.1, 0, 0.4, 0.1, 0.4, -0.2, -0.2, -0.4, 0, -0.3, -0.2, 0, -0.4, -0.2, -0.4, -0.1, 0.2, 0, 0, -0.1, -0.2, -0.1, 0.2, -0.2, -0.2, -0.1, -0.2, 0, -0.2, 0.1, -0.2, -0.2, 0.1, -0.1, -0.2, 0, 0, -0.1, 0, 0.4, 0.2, 0.5, 0.7, 0, 0.1, -0.1, 0.3, -0.1, 0.4, -0.2, -0.4, 0.1, -0.2, -0.2, 0, -0.2, -0.2, 0, -0.1, -0.2, -0.1, -0.1, -0.1, 0, 0.2, 0.1, 0.3, 0.1, 0.5, 0.5, 1.2, 1.4, 0.8, 0.3, 0.1, 0, -0.5, 0.1, -0.2, -0.3, 0.1, -0.1, -0.5, -0.3, 0, -0.4, 0.1, -0.4, 0, -0.3, -0.5, 0, -0.6, -0.2, -0.3, -0.2, -0.1, -0.3, 0, 0, -0.1, 0 };
            var list = new List<double[]> { income, production, savings, unemployment };
            var y = new Vector(consumption) { Header = "Consumption" };
            var x = new Matrix(list) { Header = new string[] { "Income", "Production", "Savings", "Unemployment" } };

            var GLM = new GeneralizedLinearModel(x, y);
            GLM.Train();

            var par = GLM.Parameters;
            var sig = GLM.ParameterStandardErrors;
            var se = GLM.StandardError;
            var df = GLM.DegreesOfFreedom;

            var true_par = new double[] { 0.26729, 0.71449, 0.04589, -0.04527, -0.20477 };
            var true_sig = new double[] { 0.03721, 0.04219, 0.02588, 0.00278, 0.10550 };
            var true_se = 0.3286;
            var true_df = 182;

            for (int i = 0; i < par.Length; i++)
            {
                Assert.AreEqual(par[i], true_par[i], 1E-3);
                Assert.AreEqual(sig[i], true_sig[i], 1E-3);
            }

            Assert.AreEqual(se, true_se, 1E-3);
            Assert.AreEqual(df, true_df);


            // Test summary output table 
            var summary = GLM.Summary();
            for (int i = 0; i < summary.Count; i++)
            {
                // Uncomment the line below to print the summary output table.
                //Debug.WriteLine(summary[i]);
            }

            /**  
                Generalized Linear Model (187 obs, 5 parameters):
                Model for predicting Consumption:
                Parameters:
                                   Estimate  Std. Error     z value    Pr(>|z|)
                Intercept           0.26729     0.03721       7.184   6.79E-013 ***
                β1                  0.71448     0.04219      16.934     < 1E-15 ***
                β2                  0.04588     0.02588       1.773      0.0762 .
                β3                 -0.04527     0.00278     -16.286     < 1E-15 ***
                β4                 -0.20484     0.10550      -1.942      0.0522 .
                ---
                Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

                Residual standard error: 0.3286 on 182 degrees of freedom
                AIC: 29.6520  AICc: 29.9835  BIC: 45.8075

                Residuals:
                       Min        1Q    Median        3Q       Max
                   -0.8830   -0.1764   -0.0368    0.1525    1.2055
            **/
        }

        /// <summary>
        /// Test log link function against R 'glm'
        /// </summary>
        [TestMethod]
        public void Test_Log()
        {

            var deaths = new double[] { 968, 43, 588, 640, 4743, 566, 325, 118, 115, 1545, 1302, 262, 2207, 1410, 833, 669, 911, 1037, 1196, 616, 766, 2120, 841, 648, 1289, 259 };
            var drivers = new double[] { 158, 11, 91, 92, 952, 109, 167, 30, 35, 298, 203, 41, 544, 254, 150, 136, 147, 146, 46, 157, 255, 403, 189, 85, 234, 38 };
            var popden = new double[] { 64, 0.4, 12, 34, 100, 17, 518, 226, 12524, 91, 68, 8.1, 180, 129, 49, 27, 76, 72, 31, 314, 655, 137, 43, 46, 63, 4.6 };
            var list = new List<double[]> { drivers, popden };
            var y = new Vector(deaths) { Header = "admits" };
            var x = new Matrix(list) { Header = new string[] { "drivers", "popden" } };

            var GLM = new GeneralizedLinearModel(x, y, true, GeneralizedLinearModel.LinkFunctionType.Log);
            GLM.Train();

            var par = GLM.Parameters;
            var sig = GLM.ParameterStandardErrors;
            var aic = GLM.AIC;
            var df = GLM.DegreesOfFreedom;

            var true_par = new double[] { 6.322e+00, 2.405e-03, -1.480e-04, };
            var true_sig = new double[] { 9.382e-03, 1.885e-05, 8.163e-06 };
            var true_aic = 4069.4;
            var true_df = 23;

            for (int i = 0; i < par.Length; i++)
            {
                Assert.AreEqual(par[i], true_par[i], 1E-2);
                Assert.AreEqual(sig[i], true_sig[i], 1E-2);
            }
            Assert.AreEqual(aic, true_aic, 1E-2);
            Assert.AreEqual(df, true_df);

            // Test summary output table 
            var summary = GLM.Summary();
            for (int i = 0; i < summary.Count; i++)
            {
                // Uncomment the line below to print the summary output table.
                Debug.WriteLine(summary[i]);
            }

            /**  
                Generalized Linear Model (26 obs, 3 parameters):
                Model for predicting admits:
                Parameters:
                                   Estimate  Std. Error     z value    Pr(>|z|)
                Intercept           6.32270     0.00033  19,261.610     < 1E-15 ***
                β1                  0.00240     0.00000   5,917.117     < 1E-15 ***
                β2                 -0.00015     0.00000    -200.082     < 1E-15 ***
                ---
                Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

                Residual standard error: 363.7627 on 23 degrees of freedom
                AIC: 4,069.4088  AICc: 4,070.4997  BIC: 4,073.1831

                Residuals:
                       Min        1Q    Median        3Q       Max
                 -672.2369 -165.4579  -30.8744  240.6816  681.4094
            **/
        }

        /// <summary>
        /// Test logistic link function against R 'glm'
        /// </summary>
        [TestMethod]
        public void Test_Logistic()
        {
            var admits = new double[] { 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0 };
            var gre = new double[] { 380, 660, 800, 640, 520, 760, 560, 400, 540, 700, 800, 440, 760, 700, 700, 480, 780, 360, 800, 540, 500, 660, 600, 680, 760, 800, 620, 520, 780, 520, 540, 760, 600, 800, 360, 400, 580, 520, 500, 520, 560, 580, 600, 500, 700, 460, 580, 500, 440, 400, 640, 440, 740, 680, 660, 740, 560, 380, 400, 600, 620, 560, 640, 680, 580, 600, 740, 620, 580, 800, 640, 300, 480, 580, 720, 720, 560, 800, 540, 620, 700, 620, 500, 380, 500, 520, 600, 600, 700, 660, 700, 720, 800, 580, 660, 660, 640, 480, 700, 400, 340, 580, 380, 540, 660, 740, 700, 480, 400, 480, 680, 420, 360, 600, 720, 620, 440, 700, 800, 340, 520, 480, 520, 500, 720, 540, 600, 740, 540, 460, 620, 640, 580, 500, 560, 500, 560, 700, 620, 600, 640, 700, 620, 580, 580, 380, 480, 560, 480, 740, 800, 400, 640, 580, 620, 580, 560, 480, 660, 700, 600, 640, 700, 520, 580, 700, 440, 720, 500, 600, 400, 540, 680, 800, 500, 620, 520, 620, 620, 300, 620, 500, 700, 540, 500, 800, 560, 580, 560, 500, 640, 800, 640, 380, 600, 560, 660, 400, 600, 580, 800, 580, 700, 420, 600, 780, 740, 640, 540, 580, 740, 580, 460, 640, 600, 660, 340, 460, 460, 560, 540, 680, 480, 800, 800, 720, 620, 540, 480, 720, 580, 600, 380, 420, 800, 620, 660, 480, 500, 700, 440, 520, 680, 620, 540, 800, 680, 440, 680, 640, 660, 620, 520, 540, 740, 640, 520, 620, 520, 640, 680, 440, 520, 620, 520, 380, 560, 600, 680, 500, 640, 540, 680, 660, 520, 600, 460, 580, 680, 660, 660, 360, 660, 520, 440, 600, 800, 660, 800, 420, 620, 800, 680, 800, 480, 520, 560, 460, 540, 720, 640, 660, 400, 680, 220, 580, 540, 580, 540, 440, 560, 660, 660, 520, 540, 300, 340, 780, 480, 540, 460, 460, 500, 420, 520, 680, 680, 560, 580, 500, 740, 660, 420, 560, 460, 620, 520, 620, 540, 660, 500, 560, 500, 580, 520, 500, 600, 580, 400, 620, 780, 620, 580, 700, 540, 760, 700, 720, 560, 720, 520, 540, 680, 460, 560, 480, 460, 620, 580, 800, 540, 680, 680, 620, 560, 560, 620, 800, 640, 540, 700, 540, 540, 660, 480, 420, 740, 580, 640, 640, 800, 660, 600, 620, 460, 620, 560, 460, 700, 600 };
            var gpa = new double[] { 3.61, 3.67, 4, 3.19, 2.93, 3, 2.98, 3.08, 3.39, 3.92, 4, 3.22, 4, 3.08, 4, 3.44, 3.87, 2.56, 3.75, 3.81, 3.17, 3.63, 2.82, 3.19, 3.35, 3.66, 3.61, 3.74, 3.22, 3.29, 3.78, 3.35, 3.4, 4, 3.14, 3.05, 3.25, 2.9, 3.13, 2.68, 2.42, 3.32, 3.15, 3.31, 2.94, 3.45, 3.46, 2.97, 2.48, 3.35, 3.86, 3.13, 3.37, 3.27, 3.34, 4, 3.19, 2.94, 3.65, 2.82, 3.18, 3.32, 3.67, 3.85, 4, 3.59, 3.62, 3.3, 3.69, 3.73, 4, 2.92, 3.39, 4, 3.45, 4, 3.36, 4, 3.12, 4, 2.9, 3.07, 2.71, 2.91, 3.6, 2.98, 3.32, 3.48, 3.28, 4, 3.83, 3.64, 3.9, 2.93, 3.44, 3.33, 3.52, 3.57, 2.88, 3.31, 3.15, 3.57, 3.33, 3.94, 3.95, 2.97, 3.56, 3.13, 2.93, 3.45, 3.08, 3.41, 3, 3.22, 3.84, 3.99, 3.45, 3.72, 3.7, 2.92, 3.74, 2.67, 2.85, 2.98, 3.88, 3.38, 3.54, 3.74, 3.19, 3.15, 3.17, 2.79, 3.4, 3.08, 2.95, 3.57, 3.33, 4, 3.4, 3.58, 3.93, 3.52, 3.94, 3.4, 3.4, 3.43, 3.4, 2.71, 2.91, 3.31, 3.74, 3.38, 3.94, 3.46, 3.69, 2.86, 2.52, 3.58, 3.49, 3.82, 3.13, 3.5, 3.56, 2.73, 3.3, 4, 3.24, 3.77, 4, 3.62, 3.51, 2.81, 3.48, 3.43, 3.53, 3.37, 2.62, 3.23, 3.33, 3.01, 3.78, 3.88, 4, 3.84, 2.79, 3.6, 3.61, 2.88, 3.07, 3.35, 2.94, 3.54, 3.76, 3.59, 3.47, 3.59, 3.07, 3.23, 3.63, 3.77, 3.31, 3.2, 4, 3.92, 3.89, 3.8, 3.54, 3.63, 3.16, 3.5, 3.34, 3.02, 2.87, 3.38, 3.56, 2.91, 2.9, 3.64, 2.98, 3.59, 3.28, 3.99, 3.02, 3.47, 2.9, 3.5, 3.58, 3.02, 3.43, 3.42, 3.29, 3.28, 3.38, 2.67, 3.53, 3.05, 3.49, 4, 2.86, 3.45, 2.76, 3.81, 2.96, 3.22, 3.04, 3.91, 3.34, 3.17, 3.64, 3.73, 3.31, 3.21, 4, 3.55, 3.52, 3.35, 3.3, 3.95, 3.51, 3.81, 3.11, 3.15, 3.19, 3.95, 3.9, 3.34, 3.24, 3.64, 3.46, 2.81, 3.95, 3.33, 3.67, 3.32, 3.12, 2.98, 3.77, 3.58, 3, 3.14, 3.94, 3.27, 3.45, 3.1, 3.39, 3.31, 3.22, 3.7, 3.15, 2.26, 3.45, 2.78, 3.7, 3.97, 2.55, 3.25, 3.16, 3.07, 3.5, 3.4, 3.3, 3.6, 3.15, 3.98, 2.83, 3.46, 3.17, 3.51, 3.13, 2.98, 4, 3.67, 3.77, 3.65, 3.46, 2.84, 3, 3.63, 3.71, 3.28, 3.14, 3.58, 3.01, 2.69, 2.7, 3.9, 3.31, 3.48, 3.34, 2.93, 4, 3.59, 2.96, 3.43, 3.64, 3.71, 3.15, 3.09, 3.2, 3.47, 3.23, 2.65, 3.95, 3.06, 3.35, 3.03, 3.35, 3.8, 3.36, 2.85, 4, 3.43, 3.12, 3.52, 3.78, 2.81, 3.27, 3.31, 3.69, 3.94, 4, 3.49, 3.14, 3.44, 3.36, 2.78, 2.93, 3.63, 4, 3.89, 3.77, 3.76, 2.42, 3.37, 3.78, 3.49, 3.63, 4, 3.12, 2.7, 3.65, 3.49, 3.51, 4, 2.62, 3.02, 3.86, 3.36, 3.17, 3.51, 3.05, 3.88, 3.38, 3.75, 3.99, 4, 3.04, 2.63, 3.65, 3.89 };
            var rank = new double[] { 3, 3, 1, 4, 4, 2, 1, 2, 3, 2, 4, 1, 1, 2, 1, 3, 4, 3, 2, 1, 3, 2, 4, 4, 2, 1, 1, 4, 2, 1, 4, 3, 3, 3, 1, 2, 1, 3, 2, 3, 2, 2, 2, 3, 2, 3, 2, 4, 4, 3, 3, 4, 4, 2, 3, 3, 3, 3, 2, 4, 2, 4, 3, 3, 3, 2, 4, 1, 1, 1, 3, 4, 4, 2, 4, 3, 3, 3, 1, 1, 4, 2, 2, 4, 3, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 4, 2, 2, 3, 3, 3, 4, 3, 2, 2, 1, 2, 3, 2, 4, 4, 3, 1, 3, 3, 2, 2, 1, 3, 2, 2, 3, 3, 3, 4, 1, 4, 2, 4, 2, 2, 2, 3, 2, 3, 4, 3, 2, 1, 2, 4, 4, 3, 4, 3, 2, 3, 1, 1, 1, 2, 2, 3, 3, 4, 2, 1, 2, 3, 2, 2, 2, 2, 2, 1, 4, 3, 3, 3, 3, 3, 3, 2, 4, 2, 2, 3, 3, 3, 3, 4, 2, 2, 4, 2, 3, 2, 2, 2, 2, 3, 3, 4, 2, 2, 3, 4, 3, 4, 3, 2, 1, 4, 1, 3, 1, 1, 3, 2, 4, 2, 2, 3, 2, 3, 1, 1, 1, 2, 3, 3, 1, 3, 2, 3, 2, 4, 2, 2, 4, 3, 2, 3, 1, 2, 2, 2, 4, 3, 2, 1, 3, 2, 1, 3, 2, 2, 3, 3, 4, 4, 2, 4, 4, 3, 2, 3, 2, 2, 2, 2, 3, 3, 3, 3, 4, 3, 2, 3, 2, 3, 2, 1, 2, 2, 3, 1, 4, 2, 2, 3, 4, 4, 2, 4, 1, 4, 4, 4, 2, 2, 2, 1, 1, 3, 1, 2, 2, 3, 2, 3, 2, 2, 3, 4, 1, 2, 2, 3, 3, 2, 3, 4, 4, 2, 2, 4, 4, 1, 3, 2, 4, 2, 3, 1, 2, 2, 2, 4, 3, 3, 1, 3, 3, 1, 3, 4, 1, 3, 4, 3, 4, 2, 3, 3, 2, 2, 2, 2, 2, 3, 3, 2, 2, 1, 2, 1, 3, 3, 1, 1, 2, 2, 1, 3, 3, 3, 1, 2, 2, 3, 1, 1, 2, 4, 2, 2, 3, 2, 2, 2, 2, 1, 2, 1, 2, 2, 2, 2, 2, 2, 3, 2, 3, 2, 3, 2, 2, 3 };
            var list = new List<double[]> { gre, gpa, rank };
            var y = new Vector(admits) { Header = "admits" };
            var x = new Matrix(list) { Header = new string[] { "gre", "gpa", "rank" } };


            var GLM = new GeneralizedLinearModel(x, y, true, GeneralizedLinearModel.LinkFunctionType.Logit);
            GLM.Train();

            var par = GLM.Parameters;
            var sig = GLM.ParameterStandardErrors;
            var aic = GLM.AIC;
            var df = GLM.DegreesOfFreedom;

            var true_par = new double[] { -3.449548, 0.002294, 0.777014, -0.560031 };
            var true_sig = new double[] { 1.132846, 0.001092, 0.327484, 0.127137 };
            var true_aic = 467.44;
            var true_df = 396;

            for (int i = 0; i < par.Length; i++)
            {
                Assert.AreEqual(par[i], true_par[i], 1E-2);
                Assert.AreEqual(sig[i], true_sig[i], 1E-2);
            }
            Assert.AreEqual(aic, true_aic, 1E-2);
            Assert.AreEqual(df, true_df);

            // Test summary output table 
            var summary = GLM.Summary();
            for (int i = 0; i < summary.Count; i++)
            {
                // Uncomment the line below to print the summary output table.
                //Debug.WriteLine(summary[i]);
            }

            /**  
                Generalized Linear Model (400 obs, 4 parameters):
                Model for predicting admits:
                Parameters:
                                   Estimate  Std. Error     z value    Pr(>|z|)
                Intercept          -3.45096     1.13540      -3.039      0.0024 **
                β1                  0.00229     0.00109       2.112      0.0347 *
                β2                  0.77743     0.32406       2.399      0.0164 *
                β3                 -0.56014     0.13156      -4.258   2.07E-005 ***
                ---
                Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

                Residual standard error: 0.4440 on 396 degrees of freedom
                AIC: 467.4418  AICc: 467.5430  BIC: 483.4076

                Residuals:
                       Min        1Q    Median        3Q       Max
                   -0.7131   -0.3239   -0.1842    0.4882    0.9057
            **/
        }

        /// <summary>
        /// Test probit link function against R 'glm'
        /// </summary>
        [TestMethod]
        public void Test_Probit()
        {
            var admits = new double[] { 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0 };
            var gre = new double[] { 380, 660, 800, 640, 520, 760, 560, 400, 540, 700, 800, 440, 760, 700, 700, 480, 780, 360, 800, 540, 500, 660, 600, 680, 760, 800, 620, 520, 780, 520, 540, 760, 600, 800, 360, 400, 580, 520, 500, 520, 560, 580, 600, 500, 700, 460, 580, 500, 440, 400, 640, 440, 740, 680, 660, 740, 560, 380, 400, 600, 620, 560, 640, 680, 580, 600, 740, 620, 580, 800, 640, 300, 480, 580, 720, 720, 560, 800, 540, 620, 700, 620, 500, 380, 500, 520, 600, 600, 700, 660, 700, 720, 800, 580, 660, 660, 640, 480, 700, 400, 340, 580, 380, 540, 660, 740, 700, 480, 400, 480, 680, 420, 360, 600, 720, 620, 440, 700, 800, 340, 520, 480, 520, 500, 720, 540, 600, 740, 540, 460, 620, 640, 580, 500, 560, 500, 560, 700, 620, 600, 640, 700, 620, 580, 580, 380, 480, 560, 480, 740, 800, 400, 640, 580, 620, 580, 560, 480, 660, 700, 600, 640, 700, 520, 580, 700, 440, 720, 500, 600, 400, 540, 680, 800, 500, 620, 520, 620, 620, 300, 620, 500, 700, 540, 500, 800, 560, 580, 560, 500, 640, 800, 640, 380, 600, 560, 660, 400, 600, 580, 800, 580, 700, 420, 600, 780, 740, 640, 540, 580, 740, 580, 460, 640, 600, 660, 340, 460, 460, 560, 540, 680, 480, 800, 800, 720, 620, 540, 480, 720, 580, 600, 380, 420, 800, 620, 660, 480, 500, 700, 440, 520, 680, 620, 540, 800, 680, 440, 680, 640, 660, 620, 520, 540, 740, 640, 520, 620, 520, 640, 680, 440, 520, 620, 520, 380, 560, 600, 680, 500, 640, 540, 680, 660, 520, 600, 460, 580, 680, 660, 660, 360, 660, 520, 440, 600, 800, 660, 800, 420, 620, 800, 680, 800, 480, 520, 560, 460, 540, 720, 640, 660, 400, 680, 220, 580, 540, 580, 540, 440, 560, 660, 660, 520, 540, 300, 340, 780, 480, 540, 460, 460, 500, 420, 520, 680, 680, 560, 580, 500, 740, 660, 420, 560, 460, 620, 520, 620, 540, 660, 500, 560, 500, 580, 520, 500, 600, 580, 400, 620, 780, 620, 580, 700, 540, 760, 700, 720, 560, 720, 520, 540, 680, 460, 560, 480, 460, 620, 580, 800, 540, 680, 680, 620, 560, 560, 620, 800, 640, 540, 700, 540, 540, 660, 480, 420, 740, 580, 640, 640, 800, 660, 600, 620, 460, 620, 560, 460, 700, 600 };
            var gpa = new double[] { 3.61, 3.67, 4, 3.19, 2.93, 3, 2.98, 3.08, 3.39, 3.92, 4, 3.22, 4, 3.08, 4, 3.44, 3.87, 2.56, 3.75, 3.81, 3.17, 3.63, 2.82, 3.19, 3.35, 3.66, 3.61, 3.74, 3.22, 3.29, 3.78, 3.35, 3.4, 4, 3.14, 3.05, 3.25, 2.9, 3.13, 2.68, 2.42, 3.32, 3.15, 3.31, 2.94, 3.45, 3.46, 2.97, 2.48, 3.35, 3.86, 3.13, 3.37, 3.27, 3.34, 4, 3.19, 2.94, 3.65, 2.82, 3.18, 3.32, 3.67, 3.85, 4, 3.59, 3.62, 3.3, 3.69, 3.73, 4, 2.92, 3.39, 4, 3.45, 4, 3.36, 4, 3.12, 4, 2.9, 3.07, 2.71, 2.91, 3.6, 2.98, 3.32, 3.48, 3.28, 4, 3.83, 3.64, 3.9, 2.93, 3.44, 3.33, 3.52, 3.57, 2.88, 3.31, 3.15, 3.57, 3.33, 3.94, 3.95, 2.97, 3.56, 3.13, 2.93, 3.45, 3.08, 3.41, 3, 3.22, 3.84, 3.99, 3.45, 3.72, 3.7, 2.92, 3.74, 2.67, 2.85, 2.98, 3.88, 3.38, 3.54, 3.74, 3.19, 3.15, 3.17, 2.79, 3.4, 3.08, 2.95, 3.57, 3.33, 4, 3.4, 3.58, 3.93, 3.52, 3.94, 3.4, 3.4, 3.43, 3.4, 2.71, 2.91, 3.31, 3.74, 3.38, 3.94, 3.46, 3.69, 2.86, 2.52, 3.58, 3.49, 3.82, 3.13, 3.5, 3.56, 2.73, 3.3, 4, 3.24, 3.77, 4, 3.62, 3.51, 2.81, 3.48, 3.43, 3.53, 3.37, 2.62, 3.23, 3.33, 3.01, 3.78, 3.88, 4, 3.84, 2.79, 3.6, 3.61, 2.88, 3.07, 3.35, 2.94, 3.54, 3.76, 3.59, 3.47, 3.59, 3.07, 3.23, 3.63, 3.77, 3.31, 3.2, 4, 3.92, 3.89, 3.8, 3.54, 3.63, 3.16, 3.5, 3.34, 3.02, 2.87, 3.38, 3.56, 2.91, 2.9, 3.64, 2.98, 3.59, 3.28, 3.99, 3.02, 3.47, 2.9, 3.5, 3.58, 3.02, 3.43, 3.42, 3.29, 3.28, 3.38, 2.67, 3.53, 3.05, 3.49, 4, 2.86, 3.45, 2.76, 3.81, 2.96, 3.22, 3.04, 3.91, 3.34, 3.17, 3.64, 3.73, 3.31, 3.21, 4, 3.55, 3.52, 3.35, 3.3, 3.95, 3.51, 3.81, 3.11, 3.15, 3.19, 3.95, 3.9, 3.34, 3.24, 3.64, 3.46, 2.81, 3.95, 3.33, 3.67, 3.32, 3.12, 2.98, 3.77, 3.58, 3, 3.14, 3.94, 3.27, 3.45, 3.1, 3.39, 3.31, 3.22, 3.7, 3.15, 2.26, 3.45, 2.78, 3.7, 3.97, 2.55, 3.25, 3.16, 3.07, 3.5, 3.4, 3.3, 3.6, 3.15, 3.98, 2.83, 3.46, 3.17, 3.51, 3.13, 2.98, 4, 3.67, 3.77, 3.65, 3.46, 2.84, 3, 3.63, 3.71, 3.28, 3.14, 3.58, 3.01, 2.69, 2.7, 3.9, 3.31, 3.48, 3.34, 2.93, 4, 3.59, 2.96, 3.43, 3.64, 3.71, 3.15, 3.09, 3.2, 3.47, 3.23, 2.65, 3.95, 3.06, 3.35, 3.03, 3.35, 3.8, 3.36, 2.85, 4, 3.43, 3.12, 3.52, 3.78, 2.81, 3.27, 3.31, 3.69, 3.94, 4, 3.49, 3.14, 3.44, 3.36, 2.78, 2.93, 3.63, 4, 3.89, 3.77, 3.76, 2.42, 3.37, 3.78, 3.49, 3.63, 4, 3.12, 2.7, 3.65, 3.49, 3.51, 4, 2.62, 3.02, 3.86, 3.36, 3.17, 3.51, 3.05, 3.88, 3.38, 3.75, 3.99, 4, 3.04, 2.63, 3.65, 3.89 };
            var rank = new double[] { 3, 3, 1, 4, 4, 2, 1, 2, 3, 2, 4, 1, 1, 2, 1, 3, 4, 3, 2, 1, 3, 2, 4, 4, 2, 1, 1, 4, 2, 1, 4, 3, 3, 3, 1, 2, 1, 3, 2, 3, 2, 2, 2, 3, 2, 3, 2, 4, 4, 3, 3, 4, 4, 2, 3, 3, 3, 3, 2, 4, 2, 4, 3, 3, 3, 2, 4, 1, 1, 1, 3, 4, 4, 2, 4, 3, 3, 3, 1, 1, 4, 2, 2, 4, 3, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 4, 2, 2, 3, 3, 3, 4, 3, 2, 2, 1, 2, 3, 2, 4, 4, 3, 1, 3, 3, 2, 2, 1, 3, 2, 2, 3, 3, 3, 4, 1, 4, 2, 4, 2, 2, 2, 3, 2, 3, 4, 3, 2, 1, 2, 4, 4, 3, 4, 3, 2, 3, 1, 1, 1, 2, 2, 3, 3, 4, 2, 1, 2, 3, 2, 2, 2, 2, 2, 1, 4, 3, 3, 3, 3, 3, 3, 2, 4, 2, 2, 3, 3, 3, 3, 4, 2, 2, 4, 2, 3, 2, 2, 2, 2, 3, 3, 4, 2, 2, 3, 4, 3, 4, 3, 2, 1, 4, 1, 3, 1, 1, 3, 2, 4, 2, 2, 3, 2, 3, 1, 1, 1, 2, 3, 3, 1, 3, 2, 3, 2, 4, 2, 2, 4, 3, 2, 3, 1, 2, 2, 2, 4, 3, 2, 1, 3, 2, 1, 3, 2, 2, 3, 3, 4, 4, 2, 4, 4, 3, 2, 3, 2, 2, 2, 2, 3, 3, 3, 3, 4, 3, 2, 3, 2, 3, 2, 1, 2, 2, 3, 1, 4, 2, 2, 3, 4, 4, 2, 4, 1, 4, 4, 4, 2, 2, 2, 1, 1, 3, 1, 2, 2, 3, 2, 3, 2, 2, 3, 4, 1, 2, 2, 3, 3, 2, 3, 4, 4, 2, 2, 4, 4, 1, 3, 2, 4, 2, 3, 1, 2, 2, 2, 4, 3, 3, 1, 3, 3, 1, 3, 4, 1, 3, 4, 3, 4, 2, 3, 3, 2, 2, 2, 2, 2, 3, 3, 2, 2, 1, 2, 1, 3, 3, 1, 1, 2, 2, 1, 3, 3, 3, 1, 2, 2, 3, 1, 1, 2, 4, 2, 2, 3, 2, 2, 2, 2, 1, 2, 1, 2, 2, 2, 2, 2, 2, 3, 2, 3, 2, 3, 2, 2, 3 };
            var list = new List<double[]> { gre, gpa, rank };
            var y = new Vector(admits) { Header = "admits" };
            var x = new Matrix(list) { Header = new string[] { "gre", "gpa", "rank" } };


            var GLM = new GeneralizedLinearModel(x, y, true, GeneralizedLinearModel.LinkFunctionType.Probit);
            GLM.Train();

            var par = GLM.Parameters;
            var sig = GLM.ParameterStandardErrors;
            var aic = GLM.AIC;
            var df = GLM.DegreesOfFreedom;

            var true_par = new double[] { -2.0915037, 0.0013982, 0.4643598, -0.3317117 };
            var true_sig = new double[] { 0.6718360, 0.0006487, 0.1950263, 0.0745524 };
            var true_aic = 467.48;
            var true_df = 396;

            for (int i = 0; i < par.Length; i++)
            {
                Assert.AreEqual(par[i], true_par[i], 1E-2);
                Assert.AreEqual(sig[i], true_sig[i], 1E-2);
            }
            Assert.AreEqual(aic, true_aic, 1E-2);
            Assert.AreEqual(df, true_df);

            // Test summary output table 
            var summary = GLM.Summary();
            for (int i = 0; i < summary.Count; i++)
            {
                // Uncomment the line below to print the summary output table.
                //Debug.WriteLine(summary[i]);
            }

            /**  
                Generalized Linear Model (400 obs, 4 parameters):
                Model for predicting admits:
                Parameters:
                                   Estimate  Std. Error     z value    Pr(>|z|)
                Intercept          -2.09205     0.67949      -3.079      0.0021 **
                β1                  0.00140     0.00065       2.145      0.0320 *
                β2                  0.46460     0.19473       2.386      0.0170 *
                β3                 -0.33184     0.07773      -4.269   1.96E-005 ***
                ---
                Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

                Residual standard error: 0.4441 on 396 degrees of freedom
                AIC: 467.4808  AICc: 467.5821  BIC: 483.4467

                Residuals:
                       Min        1Q    Median        3Q       Max
                   -0.7051   -0.3282   -0.1853    0.4915    0.9130
            **/

        }

        /// <summary>
        /// Test complementary log-log link function against R 'glm'
        /// </summary>
        [TestMethod]
        public void Test_LogLog()
        {

            var admits = new double[] { 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0 };
            var gre = new double[] { 380, 660, 800, 640, 520, 760, 560, 400, 540, 700, 800, 440, 760, 700, 700, 480, 780, 360, 800, 540, 500, 660, 600, 680, 760, 800, 620, 520, 780, 520, 540, 760, 600, 800, 360, 400, 580, 520, 500, 520, 560, 580, 600, 500, 700, 460, 580, 500, 440, 400, 640, 440, 740, 680, 660, 740, 560, 380, 400, 600, 620, 560, 640, 680, 580, 600, 740, 620, 580, 800, 640, 300, 480, 580, 720, 720, 560, 800, 540, 620, 700, 620, 500, 380, 500, 520, 600, 600, 700, 660, 700, 720, 800, 580, 660, 660, 640, 480, 700, 400, 340, 580, 380, 540, 660, 740, 700, 480, 400, 480, 680, 420, 360, 600, 720, 620, 440, 700, 800, 340, 520, 480, 520, 500, 720, 540, 600, 740, 540, 460, 620, 640, 580, 500, 560, 500, 560, 700, 620, 600, 640, 700, 620, 580, 580, 380, 480, 560, 480, 740, 800, 400, 640, 580, 620, 580, 560, 480, 660, 700, 600, 640, 700, 520, 580, 700, 440, 720, 500, 600, 400, 540, 680, 800, 500, 620, 520, 620, 620, 300, 620, 500, 700, 540, 500, 800, 560, 580, 560, 500, 640, 800, 640, 380, 600, 560, 660, 400, 600, 580, 800, 580, 700, 420, 600, 780, 740, 640, 540, 580, 740, 580, 460, 640, 600, 660, 340, 460, 460, 560, 540, 680, 480, 800, 800, 720, 620, 540, 480, 720, 580, 600, 380, 420, 800, 620, 660, 480, 500, 700, 440, 520, 680, 620, 540, 800, 680, 440, 680, 640, 660, 620, 520, 540, 740, 640, 520, 620, 520, 640, 680, 440, 520, 620, 520, 380, 560, 600, 680, 500, 640, 540, 680, 660, 520, 600, 460, 580, 680, 660, 660, 360, 660, 520, 440, 600, 800, 660, 800, 420, 620, 800, 680, 800, 480, 520, 560, 460, 540, 720, 640, 660, 400, 680, 220, 580, 540, 580, 540, 440, 560, 660, 660, 520, 540, 300, 340, 780, 480, 540, 460, 460, 500, 420, 520, 680, 680, 560, 580, 500, 740, 660, 420, 560, 460, 620, 520, 620, 540, 660, 500, 560, 500, 580, 520, 500, 600, 580, 400, 620, 780, 620, 580, 700, 540, 760, 700, 720, 560, 720, 520, 540, 680, 460, 560, 480, 460, 620, 580, 800, 540, 680, 680, 620, 560, 560, 620, 800, 640, 540, 700, 540, 540, 660, 480, 420, 740, 580, 640, 640, 800, 660, 600, 620, 460, 620, 560, 460, 700, 600 };
            var gpa = new double[] { 3.61, 3.67, 4, 3.19, 2.93, 3, 2.98, 3.08, 3.39, 3.92, 4, 3.22, 4, 3.08, 4, 3.44, 3.87, 2.56, 3.75, 3.81, 3.17, 3.63, 2.82, 3.19, 3.35, 3.66, 3.61, 3.74, 3.22, 3.29, 3.78, 3.35, 3.4, 4, 3.14, 3.05, 3.25, 2.9, 3.13, 2.68, 2.42, 3.32, 3.15, 3.31, 2.94, 3.45, 3.46, 2.97, 2.48, 3.35, 3.86, 3.13, 3.37, 3.27, 3.34, 4, 3.19, 2.94, 3.65, 2.82, 3.18, 3.32, 3.67, 3.85, 4, 3.59, 3.62, 3.3, 3.69, 3.73, 4, 2.92, 3.39, 4, 3.45, 4, 3.36, 4, 3.12, 4, 2.9, 3.07, 2.71, 2.91, 3.6, 2.98, 3.32, 3.48, 3.28, 4, 3.83, 3.64, 3.9, 2.93, 3.44, 3.33, 3.52, 3.57, 2.88, 3.31, 3.15, 3.57, 3.33, 3.94, 3.95, 2.97, 3.56, 3.13, 2.93, 3.45, 3.08, 3.41, 3, 3.22, 3.84, 3.99, 3.45, 3.72, 3.7, 2.92, 3.74, 2.67, 2.85, 2.98, 3.88, 3.38, 3.54, 3.74, 3.19, 3.15, 3.17, 2.79, 3.4, 3.08, 2.95, 3.57, 3.33, 4, 3.4, 3.58, 3.93, 3.52, 3.94, 3.4, 3.4, 3.43, 3.4, 2.71, 2.91, 3.31, 3.74, 3.38, 3.94, 3.46, 3.69, 2.86, 2.52, 3.58, 3.49, 3.82, 3.13, 3.5, 3.56, 2.73, 3.3, 4, 3.24, 3.77, 4, 3.62, 3.51, 2.81, 3.48, 3.43, 3.53, 3.37, 2.62, 3.23, 3.33, 3.01, 3.78, 3.88, 4, 3.84, 2.79, 3.6, 3.61, 2.88, 3.07, 3.35, 2.94, 3.54, 3.76, 3.59, 3.47, 3.59, 3.07, 3.23, 3.63, 3.77, 3.31, 3.2, 4, 3.92, 3.89, 3.8, 3.54, 3.63, 3.16, 3.5, 3.34, 3.02, 2.87, 3.38, 3.56, 2.91, 2.9, 3.64, 2.98, 3.59, 3.28, 3.99, 3.02, 3.47, 2.9, 3.5, 3.58, 3.02, 3.43, 3.42, 3.29, 3.28, 3.38, 2.67, 3.53, 3.05, 3.49, 4, 2.86, 3.45, 2.76, 3.81, 2.96, 3.22, 3.04, 3.91, 3.34, 3.17, 3.64, 3.73, 3.31, 3.21, 4, 3.55, 3.52, 3.35, 3.3, 3.95, 3.51, 3.81, 3.11, 3.15, 3.19, 3.95, 3.9, 3.34, 3.24, 3.64, 3.46, 2.81, 3.95, 3.33, 3.67, 3.32, 3.12, 2.98, 3.77, 3.58, 3, 3.14, 3.94, 3.27, 3.45, 3.1, 3.39, 3.31, 3.22, 3.7, 3.15, 2.26, 3.45, 2.78, 3.7, 3.97, 2.55, 3.25, 3.16, 3.07, 3.5, 3.4, 3.3, 3.6, 3.15, 3.98, 2.83, 3.46, 3.17, 3.51, 3.13, 2.98, 4, 3.67, 3.77, 3.65, 3.46, 2.84, 3, 3.63, 3.71, 3.28, 3.14, 3.58, 3.01, 2.69, 2.7, 3.9, 3.31, 3.48, 3.34, 2.93, 4, 3.59, 2.96, 3.43, 3.64, 3.71, 3.15, 3.09, 3.2, 3.47, 3.23, 2.65, 3.95, 3.06, 3.35, 3.03, 3.35, 3.8, 3.36, 2.85, 4, 3.43, 3.12, 3.52, 3.78, 2.81, 3.27, 3.31, 3.69, 3.94, 4, 3.49, 3.14, 3.44, 3.36, 2.78, 2.93, 3.63, 4, 3.89, 3.77, 3.76, 2.42, 3.37, 3.78, 3.49, 3.63, 4, 3.12, 2.7, 3.65, 3.49, 3.51, 4, 2.62, 3.02, 3.86, 3.36, 3.17, 3.51, 3.05, 3.88, 3.38, 3.75, 3.99, 4, 3.04, 2.63, 3.65, 3.89 };
            var rank = new double[] { 3, 3, 1, 4, 4, 2, 1, 2, 3, 2, 4, 1, 1, 2, 1, 3, 4, 3, 2, 1, 3, 2, 4, 4, 2, 1, 1, 4, 2, 1, 4, 3, 3, 3, 1, 2, 1, 3, 2, 3, 2, 2, 2, 3, 2, 3, 2, 4, 4, 3, 3, 4, 4, 2, 3, 3, 3, 3, 2, 4, 2, 4, 3, 3, 3, 2, 4, 1, 1, 1, 3, 4, 4, 2, 4, 3, 3, 3, 1, 1, 4, 2, 2, 4, 3, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 4, 2, 2, 3, 3, 3, 4, 3, 2, 2, 1, 2, 3, 2, 4, 4, 3, 1, 3, 3, 2, 2, 1, 3, 2, 2, 3, 3, 3, 4, 1, 4, 2, 4, 2, 2, 2, 3, 2, 3, 4, 3, 2, 1, 2, 4, 4, 3, 4, 3, 2, 3, 1, 1, 1, 2, 2, 3, 3, 4, 2, 1, 2, 3, 2, 2, 2, 2, 2, 1, 4, 3, 3, 3, 3, 3, 3, 2, 4, 2, 2, 3, 3, 3, 3, 4, 2, 2, 4, 2, 3, 2, 2, 2, 2, 3, 3, 4, 2, 2, 3, 4, 3, 4, 3, 2, 1, 4, 1, 3, 1, 1, 3, 2, 4, 2, 2, 3, 2, 3, 1, 1, 1, 2, 3, 3, 1, 3, 2, 3, 2, 4, 2, 2, 4, 3, 2, 3, 1, 2, 2, 2, 4, 3, 2, 1, 3, 2, 1, 3, 2, 2, 3, 3, 4, 4, 2, 4, 4, 3, 2, 3, 2, 2, 2, 2, 3, 3, 3, 3, 4, 3, 2, 3, 2, 3, 2, 1, 2, 2, 3, 1, 4, 2, 2, 3, 4, 4, 2, 4, 1, 4, 4, 4, 2, 2, 2, 1, 1, 3, 1, 2, 2, 3, 2, 3, 2, 2, 3, 4, 1, 2, 2, 3, 3, 2, 3, 4, 4, 2, 2, 4, 4, 1, 3, 2, 4, 2, 3, 1, 2, 2, 2, 4, 3, 3, 1, 3, 3, 1, 3, 4, 1, 3, 4, 3, 4, 2, 3, 3, 2, 2, 2, 2, 2, 3, 3, 2, 2, 1, 2, 1, 3, 3, 1, 1, 2, 2, 1, 3, 3, 3, 1, 2, 2, 3, 1, 1, 2, 4, 2, 2, 3, 2, 2, 2, 2, 1, 2, 1, 2, 2, 2, 2, 2, 2, 3, 2, 3, 2, 3, 2, 2, 3 };
            var list = new List<double[]> { gre, gpa, rank };
            var y = new Vector(admits) { Header = "admits" };
            var x = new Matrix(list) { Header = new string[] { "gre", "gpa", "rank" } };


            var GLM = new GeneralizedLinearModel(x, y, true, GeneralizedLinearModel.LinkFunctionType.ComplementaryLogLog);
            GLM.Train();

            var par = GLM.Parameters;
            var sig = GLM.ParameterStandardErrors;
            var aic = GLM.AIC;
            var df = GLM.DegreesOfFreedom;

            var true_par = new double[] { -3.0603413, 0.0017513, 0.6213458, -0.4587797 };
            var true_sig = new double[] { 0.9223750, 0.0008744, 0.2626932, 0.1014823 };
            var true_aic = 467.5;
            var true_df = 396;

            for (int i = 0; i < par.Length; i++)
            {
                Assert.AreEqual(par[i], true_par[i], 1E-2);
                Assert.AreEqual(sig[i], true_sig[i], 1E-2);
            }
            Assert.AreEqual(aic, true_aic, 1E-2);
            Assert.AreEqual(df, true_df);

            // Test summary output table 
            var summary = GLM.Summary();
            for (int i = 0; i < summary.Count; i++)
            {
                // Uncomment the line below to print the summary output table.
                Debug.WriteLine(summary[i]);
            }

            /**  
                Generalized Linear Model (400 obs, 4 parameters):
                Model for predicting admits:
                Parameters:
                                   Estimate  Std. Error     z value    Pr(>|z|)
                Intercept          -3.05923     0.91259      -3.352      0.0008 ***
                β1                  0.00175     0.00086       2.039      0.0414 *
                β2                  0.62115     0.25702       2.417      0.0157 *
                β3                 -0.45876     0.10382      -4.419   9.92E-006 ***
                ---
                Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

                Residual standard error: 0.4440 on 396 degrees of freedom
                AIC: 467.5026  AICc: 467.6038  BIC: 483.4684

                Residuals:
                       Min        1Q    Median        3Q       Max
                   -0.7575   -0.3162   -0.1879    0.4899    0.8939
            **/
        }


    }
}
